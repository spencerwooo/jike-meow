<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <link rel="stylesheet"
        href="style/index.css">
  <script src="scripts/vue.min.js"></script>
</head>

<body>
  <div id="app"
       :class="{ full: accessToken && notifications && isUIEnabled }">
    <!-- ç™»å½• -->
    <div id="login"
         v-if="!accessToken && isUIEnabled">
      <div id="qrcode-container">
        <div class="qrcode-framer"
             v-if="isQrCodeLoading">
          <p v-if="isQrCodeScanning">è¯·åœ¨æ‰‹æœºä¸Šç‚¹å‡»<br><b>ç¡®è®¤ç™»é™†</b></p>
        </div>
        <div id="qrcode"></div>
      </div>
    </div>
    <!-- é€šçŸ¥åˆ—è¡¨ -->
    <div id="notification"
         v-if="accessToken && notifications && isUIEnabled">
      <div class="n-item"
           v-for="item in notifications"
           :class="{ viewed: item.isViewed && isNotificationCheckingFunctionEnabled }">
        <!-- èµäº†ä½ çš„åŠ¨æ€ -->
        <div class="n-item-list"
             v-if="item.type === 'LIKE_PERSONAL_UPDATE'">
          <div class="n-like-users">
            <div class="n-like-users-name">
              <a v-for="user in item.actionItem.users">{{ user.screenName }}</a>
              <span v-if="item.actionItem.users.length > 1">ç­‰ {{ item.actionItem.usersCount }} äºº</span>èµäº†ä½ çš„åŠ¨æ€
            </div>
            <div class="n-like-users-avatar">
              <a v-for="avatar in item.actionItem.users"
                 :href="'https://web.okjike.com/user/' + avatar.username"
                 :class="{ verified: avatar.isVerified }"
                 :style="{ backgroundImage: 'url(' + avatar.profileImageUrl + ')' }"
                 target="_blank"></a>
            </div>
          </div>
          <div class="n-like-inline-block">
            <!-- è¯¥åŠ¨æ€å·²åˆ é™¤ -->
            <div class="n-like-no-link"
                 v-if="item.referenceItem.status === 'DELETED'"></div>
            <!-- åŠ¨æ€ - æœ‰å›¾ -->
            <a class="n-like-post"
               v-if="item.referenceItem.referenceImageUrl"
               :style="{ backgroundImage: 'url(' + item.referenceItem.referenceImageUrl + ')' }"
               :href="'https://web.okjike.com/' + (item.referenceItem.type === 'OFFICIAL_MESSAGE' ? 'message-detail/' : 'post-detail/') + item.referenceItem.id + '/' + (item.referenceItem.type === 'ORIGINAL_POST' ? 'originalPost' : item.referenceItem.type === 'OFFICIAL_MESSAGE' ? 'officialMessage' : item.referenceItem.type)"
               target="_blank">
            </a>
            <!-- åŠ¨æ€ - æ— å›¾ -->
            <a class="n-like-post"
               v-else
               :href="'https://web.okjike.com/' + (item.referenceItem.type === 'OFFICIAL_MESSAGE' ? 'message-detail/' : 'post-detail/') + item.referenceItem.id + '/' + (item.referenceItem.type === 'ORIGINAL_POST' ? 'originalPost' : item.referenceItem.type === 'OFFICIAL_MESSAGE' ? 'officialMessage' : item.referenceItem.type)"
               target="_blank">
              <span v-if="!item.referenceItem.referenceImageUrl"
                    v-html="item.referenceItem.content.replace(/\n/g, '<br/>')"></span>
            </a>
          </div>
        </div>
        <!-- èµäº†ä½ çš„è¯„è®º -->
        <div class="n-item-list"
             v-else-if="item.type === 'LIKE_PERSONAL_UPDATE_COMMENT' ||
             item.type === 'LIKE_COMMENT' ||
             item.type === 'LIKE_ANSWER_COMMENT'">
          <div class="n-like-users">
            <div class="n-like-users-name">
              <a v-for="user in item.actionItem.users">{{ user.screenName }}</a>
              <span v-if="item.actionItem.users.length > 1">ç­‰ {{ item.actionItem.usersCount }} äºº</span>èµäº†ä½ çš„è¯„è®º
            </div>
            <div class="n-like-users-avatar">
              <a v-for="avatar in item.actionItem.users"
                 :class="{ verified: avatar.isVerified }"
                 :href="'https://web.okjike.com/user/' + avatar.username"
                 :style="{ backgroundImage: 'url(' + avatar.profileImageUrl + ')' }"
                 target="_blank"></a>
            </div>
          </div>
          <div class="n-like-inline-block">
            <!-- è¯¥åŠ¨æ€å·²åˆ é™¤ -->
            <div class="n-like-no-link"
                 v-if="item.referenceItem.status === 'DELETED'"></div>
            <a class="n-like-post"
               v-if="item.type === 'LIKE_PERSONAL_UPDATE_COMMENT' || item.type === 'LIKE_COMMENT'"
               :href="'https://web.okjike.com/' + (item.referenceItem.targetType === 'OFFICIAL_MESSAGE' ? 'message-detail/' : 'post-detail/') + item.referenceItem.targetId + '/' + (item.referenceItem.targetType === 'ORIGINAL_POST' ? 'originalPost' : item.referenceItem.targetType === 'OFFICIAL_MESSAGE' ? 'officialMessage' : item.referenceItem.targetType)"
               target="_blank">
              <span v-if="!item.referenceItem.referenceImageUrl"
                    v-html="item.referenceItem.content.replace(/\n/g, '<br/>')"></span>
            </a>
            <a class="n-like-post"
               v-else-if="item.type === 'LIKE_ANSWER_COMMENT'">
              <span v-if="!item.referenceItem.referenceImageUrl"
                    v-html="item.referenceItem.content.replace(/\n/g, '<br/>')"></span>
            </a>
          </div>
        </div>
        <!-- èµäº†ä½ çš„æé—® -->
        <div class="n-item-list"
             v-else-if="item.type === 'LIKE_QUESTION'">
          <div class="n-like-users">
            <div class="n-like-users-name">
              <a v-for="user in item.actionItem.users">{{ user.screenName }}</a>
              <span v-if="item.actionItem.users.length > 1">ç­‰ {{ item.actionItem.usersCount }} äºº</span>èµäº†ä½ çš„æé—®
            </div>
            <div class="n-like-users-avatar">
              <a v-for="avatar in item.actionItem.users"
                 :class="{ verified: avatar.isVerified }"
                 :href="'https://web.okjike.com/user/' + avatar.username"
                 :style="{ backgroundImage: 'url(' + avatar.profileImageUrl + ')' }"
                 target="_blank"></a>
            </div>
          </div>
          <div class="n-like-inline-block">
            <!-- è¯¥åŠ¨æ€å·²åˆ é™¤ -->
            <div class="n-like-no-link"
                 v-if="item.referenceItem.status === 'DELETED'"></div>
            <a class="n-like-post">
              <span v-if="!item.referenceItem.referenceImageUrl"
                    v-html="item.referenceItem.content.replace(/\n/g, '<br/>')"></span>
            </a>
          </div>
        </div>
        <!-- èµäº†ä½ çš„å›ç­” -->
        <div class="n-item-list"
             v-else-if="item.type === 'UPVOTE_ANSWER'">
          <div class="n-like-users">
            <div class="n-like-users-name">
              <a v-for="user in item.actionItem.users">{{ user.screenName }}</a>
              <span v-if="item.actionItem.users.length > 1">ç­‰ {{ item.actionItem.usersCount }} äºº</span>èµäº†ä½ çš„å›ç­”
            </div>
            <div class="n-like-users-avatar">
              <a v-for="avatar in item.actionItem.users"
                 :class="{ verified: avatar.isVerified }"
                 :href="'https://web.okjike.com/user/' + avatar.username"
                 :style="{ backgroundImage: 'url(' + avatar.profileImageUrl + ')' }"
                 target="_blank"></a>
            </div>
          </div>
          <div class="n-like-inline-block">
            <!-- è¯¥åŠ¨æ€å·²åˆ é™¤ -->
            <div class="n-like-no-link"
                 v-if="item.referenceItem.status === 'DELETED'"></div>
            <a class="n-like-post">
              <span v-if="!item.referenceItem.referenceImageUrl"
                    v-html="item.referenceItem.content.replace(/\n/g, '<br/>')"></span>
            </a>
          </div>
        </div>
        <!-- è½¬å‘äº†ä½ çš„åŠ¨æ€ -->
        <div class="n-item-list"
             v-else-if="item.type === 'PERSONAL_UPDATE_REPOSTED'">
          <a class="n-repost-avatar"
             target="_blank"
             :class="{ verified: item.actionItem.users[0].isVerified }"
             :style="{ backgroundImage: 'url(' + item.actionItem.users[0].profileImageUrl + ')' }"
             :href="'https://web.okjike.com/user/' + item.actionItem.users[0].username"></a>
          <div class="n-repost-user">
            <p class="n-repost-users-name">{{ item.actionItem.users[0].screenName }} è½¬å‘äº†ä½ çš„åŠ¨æ€</p>
            <p class="n-repost-users-comment">{{ item.actionItem.content ? item.actionItem.content + '&nbsp;' : '' }}
              <a @click.self.stop="previewImage(item.actionItem.pictures[0].picUrl)"
                 v-if="item.actionItem.pictures.length > 0">æŸ¥çœ‹å›¾ç‰‡</a>
            </p>
          </div>
          <div class="n-like-inline-block">
            <!-- è¯¥åŠ¨æ€å·²åˆ é™¤ -->
            <div class="n-like-no-link"
                 v-if="item.referenceItem.status === 'DELETED'"></div>
            <!-- åŠ¨æ€ - æœ‰å›¾ -->
            <a class="n-repost-post"
               v-if="item.referenceItem.referenceImageUrl"
               :style="{ backgroundImage: 'url(' + item.referenceItem.referenceImageUrl + ')' }"
               :href="'https://web.okjike.com/post-detail/' + item.actionItem.id + '/repost'"
               target="_blank">
            </a>
            <!-- åŠ¨æ€ - æ— å›¾ -->
            <a class="n-repost-post"
               v-else
               :href="'https://web.okjike.com/post-detail' + item.actionItem.id + '/repost'"
               target="_blank">
              <span v-if="!item.referenceItem.referenceImageUrl"
                    v-html="item.referenceItem.content.replace(/\n/g, '<br/>')"></span>
            </a>
          </div>
        </div>
        <!-- è¯„è®ºäº†ä½  -->
        <div class="n-item-list"
             v-else-if="item.type === 'COMMENT_PERSONAL_UPDATE'">
          <a class="n-comment-avatar"
             target="_blank"
             :class="{ verified: item.actionItem.users[0].isVerified }"
             :style="{ backgroundImage: 'url(' + item.actionItem.users[0].profileImageUrl + ')' }"
             :href="'https://web.okjike.com/user/' + item.actionItem.users[0].username"></a>
          <div class="n-comment-user">
            <p class="n-comment-users-name">
              <span>{{ item.actionItem.users[0].screenName }}</span> è¯„è®ºäº†ä½ 
            </p>
            <p class="n-comment-users-comment">{{ item.actionItem.content ? item.actionItem.content + '&nbsp;' : '' }}
              <a @click.self.stop="previewImage(item.actionItem.pictures[0].picUrl)"
                 v-if="item.actionItem.pictures.length > 0">æŸ¥çœ‹å›¾ç‰‡</a>
            </p>
          </div>
          <div class="n-like-inline-block">
            <!-- è¯¥åŠ¨æ€å·²åˆ é™¤ -->
            <div class="n-like-no-link"
                 v-if="item.referenceItem.status === 'DELETED'"></div>
            <!-- åŠ¨æ€ - æœ‰å›¾ -->
            <a class="n-comment-post"
               v-if="item.referenceItem.referenceImageUrl"
               :style="{ backgroundImage: 'url(' + item.referenceItem.referenceImageUrl + ')' }"
               :href="'https://web.okjike.com/' + (item.referenceItem.type === 'OFFICIAL_MESSAGE' ? 'message-detail/' : 'post-detail/') + item.referenceItem.id + '/' + (item.referenceItem.type === 'ORIGINAL_POST' ? 'originalPost' : item.referenceItem.type === 'OFFICIAL_MESSAGE' ? 'officialMessage' : item.referenceItem.type)"
               target="_blank">
            </a>
            <!-- åŠ¨æ€ - æ— å›¾ -->
            <a class="n-comment-post"
               v-else
               :href="'https://web.okjike.com/' + (item.referenceItem.type === 'OFFICIAL_MESSAGE' ? 'message-detail/' : 'post-detail/') + item.referenceItem.id + '/' + (item.referenceItem.type === 'ORIGINAL_POST' ? 'originalPost' : item.referenceItem.type === 'OFFICIAL_MESSAGE' ? 'officialMessage' : item.referenceItem.type)"
               target="_blank">
              <span v-if="!item.referenceItem.referenceImageUrl"
                    v-html="item.referenceItem.content.replace(/\n/g, '<br/>')"></span>
            </a>
          </div>
        </div>
        <!-- å›å¤äº†ä½  -->
        <div class="n-item-list"
             v-else-if="item.type === 'REPLIED_TO_PERSONAL_UPDATE_COMMENT' ||
             item.type === 'REPLY_TO_COMMENT' ||
             item.type === 'REPLIED_TO_ANSWER_COMMENT'">
          <a class="n-comment-avatar"
             target="_blank"
             :class="{ verified: item.actionItem.users[0].isVerified }"
             :style="{ backgroundImage: 'url(' + item.actionItem.users[0].profileImageUrl + ')' }"
             :href="'https://web.okjike.com/user/' + item.actionItem.users[0].username"></a>
          <div class="n-comment-user">
            <p class="n-comment-users-name">
              <span>{{ item.actionItem.users[0].screenName }}</span> å›å¤äº†ä½ 
            </p>
            <p class="n-comment-users-comment">{{ item.actionItem.content ? item.actionItem.content + '&nbsp;' : '' }}
              <a @click.self.stop="previewImage(item.actionItem.pictures[0].picUrl)"
                 v-if="item.actionItem.pictures.length > 0">æŸ¥çœ‹å›¾ç‰‡</a>
            </p>
          </div>
          <div class="n-like-inline-block">
            <!-- è¯¥åŠ¨æ€å·²åˆ é™¤ -->
            <div class="n-like-no-link"
                 v-if="item.referenceItem.status === 'DELETED'"></div>
            <!-- åŠ¨æ€ - æœ‰å›¾ -->
            <a class="n-comment-post"
               v-if="item.referenceItem.referenceImageUrl && item.type !== 'REPLIED_TO_ANSWER_COMMENT'"
               :style="{ backgroundImage: 'url(' + item.referenceItem.referenceImageUrl + ')' }"
               :href="'https://web.okjike.com/' + (item.referenceItem.targetType === 'OFFICIAL_MESSAGE' ? 'message-detail/' : 'post-detail/') + item.referenceItem.targetId + '/' + (item.referenceItem.targetType === 'ORIGINAL_POST' ? 'originalPost' : item.referenceItem.targetType === 'OFFICIAL_MESSAGE' ? 'officialMessage' : item.referenceItem.targetType)"
               target="_blank">
            </a>
            <!-- åŠ¨æ€ - æ— å›¾ -->
            <a class="n-comment-post"
               v-else-if="!item.referenceItem.referenceImageUrl && item.type !== 'REPLIED_TO_ANSWER_COMMENT'"
               :href="'https://web.okjike.com/' + (item.referenceItem.targetType === 'OFFICIAL_MESSAGE' ? 'message-detail/' : 'post-detail/') + item.referenceItem.targetId + '/' + (item.referenceItem.targetType === 'ORIGINAL_POST' ? 'originalPost' : item.referenceItem.targetType === 'OFFICIAL_MESSAGE' ? 'officialMessage' : item.referenceItem.targetType)"
               target="_blank">
              <span v-if="!item.referenceItem.referenceImageUrl"
                    v-html="item.referenceItem.content.replace(/\n/g, '<br/>')"></span>
            </a>
            <!-- åŠ¨æ€ - æœ‰å›¾ -->
            <a class="n-comment-post"
               v-else-if="item.referenceItem.referenceImageUrl && item.type === 'REPLIED_TO_ANSWER_COMMENT'"
               :style="{ backgroundImage: 'url(' + item.referenceItem.referenceImageUrl + ')' }">
            </a>
            <!-- åŠ¨æ€ - æ— å›¾ -->
            <a class="n-comment-post"
               v-else-if="!item.referenceItem.referenceImageUrl && item.type === 'REPLIED_TO_ANSWER_COMMENT'">
              <span v-if="!item.referenceItem.referenceImageUrl"
                    v-html="item.referenceItem.content.replace(/\n/g, '<br/>')"></span>
            </a>
          </div>
        </div>
        <!-- å›ç­”äº†ä½ çš„é—®é¢˜ -->
        <div class="n-item-list"
             v-else-if="item.type === 'ANSWER_QUESTION'">
          <a class="n-comment-avatar"
             target="_blank"
             :class="{ verified: item.actionItem.users[0].isVerified }"
             :style="{ backgroundImage: 'url(' + item.actionItem.users[0].profileImageUrl + ')' }"
             :href="'https://web.okjike.com/user/' + item.actionItem.users[0].username"></a>
          <div class="n-comment-user">
            <p class="n-comment-users-name">
              <span>{{ item.actionItem.users[0].screenName }}</span> å›ç­”äº†ä½ çš„é—®é¢˜
            </p>
            <p class="n-comment-users-comment">{{ item.actionItem.content ? item.actionItem.content + '&nbsp;' : '' }}
              <a @click.self.stop="previewImage(item.actionItem.pictures[0].picUrl)"
                 v-if="item.actionItem.pictures.length > 0">æŸ¥çœ‹å›¾ç‰‡</a>
            </p>
          </div>
          <div class="n-like-inline-block">
            <!-- è¯¥åŠ¨æ€å·²åˆ é™¤ -->
            <div class="n-like-no-link"
                 v-if="item.referenceItem.status === 'DELETED'"></div>
            <!-- åŠ¨æ€ - æœ‰å›¾ -->
            <a class="n-comment-post"
               v-if="item.referenceItem.referenceImageUrl"
               :style="{ backgroundImage: 'url(' + item.referenceItem.referenceImageUrl + ')' }">
            </a>
            <!-- åŠ¨æ€ - æ— å›¾ -->
            <a class="n-comment-post"
               v-else>
              <span v-if="!item.referenceItem.referenceImageUrl"
                    v-html="item.referenceItem.content.replace(/\n/g, '<br/>')"></span>
            </a>
          </div>
        </div>
        <!-- è¯„è®ºäº†ä½ çš„å›ç­” -->
        <div class="n-item-list"
             v-else-if="item.type === 'COMMENT_ANSWER'">
          <a class="n-comment-avatar"
             target="_blank"
             :class="{ verified: item.actionItem.users[0].isVerified }"
             :style="{ backgroundImage: 'url(' + item.actionItem.users[0].profileImageUrl + ')' }"
             :href="'https://web.okjike.com/user/' + item.actionItem.users[0].username"></a>
          <div class="n-comment-user">
            <p class="n-comment-users-name">
              <span>{{ item.actionItem.users[0].screenName }}</span> è¯„è®ºäº†ä½ çš„å›ç­”
            </p>
            <p class="n-comment-users-comment">{{ item.actionItem.content ? item.actionItem.content + '&nbsp;' : '' }}
              <a @click.self.stop="previewImage(item.actionItem.pictures[0].picUrl)"
                 v-if="item.actionItem.pictures.length > 0">æŸ¥çœ‹å›¾ç‰‡</a>
            </p>
          </div>
          <div class="n-like-inline-block">
            <!-- è¯¥åŠ¨æ€å·²åˆ é™¤ -->
            <div class="n-like-no-link"
                 v-if="item.referenceItem.status === 'DELETED'"></div>
            <!-- åŠ¨æ€ - æœ‰å›¾ -->
            <a class="n-comment-post"
               v-if="item.referenceItem.referenceImageUrl"
               :style="{ backgroundImage: 'url(' + item.referenceItem.referenceImageUrl + ')' }">
            </a>
            <!-- åŠ¨æ€ - æ— å›¾ -->
            <a class="n-comment-post"
               v-else>
              <span v-if="!item.referenceItem.referenceImageUrl"
                    v-html="item.referenceItem.content.replace(/\n/g, '<br/>')"></span>
            </a>
          </div>
        </div>
        <!-- å…³æ³¨äº†ä½  -->
        <div class="n-item-list"
             v-else-if="item.type === 'USER_FOLLOWED'">
          <a class="n-comment-avatar"
             target="_blank"
             :class="{ verified: item.actionItem.users[0].isVerified }"
             :style="{ backgroundImage: 'url(' + item.actionItem.users[0].profileImageUrl + ')' }"
             :href="'https://web.okjike.com/user/' + item.actionItem.users[0].username"></a>
          <div class="n-comment-user">
            <p class="n-comment-users-name">
              <span>{{ item.actionItem.users[0].screenName }}</span> å…³æ³¨äº†ä½ 
            </p>
            <p class="n-comment-users-comment">{{ item.actionItem.users[0].briefIntro }}</p>
          </div>
          <div class="n-like-inline-block">
            <a class="n-comment-post"></a>
          </div>
        </div>
        <!-- æœªçŸ¥æ¶ˆæ¯ç±»å‹ -->
        <div class="n-unknown"
             v-else>
          <div>ä¸æ”¯æŒçš„æ¶ˆæ¯ç±»å‹<br>
            <a :href="'https://github.com/coder-ysj/jike-meow/issues/new?title=å½“å‰æ­£åœ¨ä½¿ç”¨çš„ç‰ˆæœ¬å·: ' + chrome.runtime.getManifest().version"
               target="_blank">ç‚¹å‡»æ­¤å¤„</a> åé¦ˆç»™ä½œè€…</div>
        </div>
        <!-- æ—¶é—´æ˜¾ç¤º -->
        <div class="n-time-display">{{ reformatTime(item.updatedAt) }}</div>
      </div>
      <!-- æ­£åœ¨åŠ è½½ -->
      <p id="notification-loading"
         v-if="isNotificationLoading">ğŸ± æ­£åœ¨åŠ è½½æ•°æ®â€¦</p>
      <!-- åŠ è½½å¤±è´¥ -->
      <p id="notification-error"
         v-if="isError"
         @click.self.stop="getNotificationList()">ğŸŒš åŠ è½½å¤±è´¥ï¼Œè¯·ç‚¹å‡»é‡è¯•</p>
    </div>
    <!-- æŒ‰é’® -->
    <button class="primary"
            @click.self.stop="getUuid()"
            v-if="!accessToken && isUIEnabled">åˆ·æ–°äºŒç»´ç </button>
    <div class="button-container"
         v-if="accessToken && isUIEnabled">
      <button class="primary half"
              @click.self.stop="logIn()">ç½‘é¡µç™»å½•</button>
      <button class="primary half"
              style="margin-left: 10px;"
              @click.self.stop="logOut()">é€€å‡ºç™»å½•</button>
    </div>
    <div class="button-container"
         v-if="authToken">
      <button v-if="!isNotificationLoading"
              class="half"
              style="margin-right: 10px;"
              @click.self.stop="getNotificationList('refresh')">æŸ¥çœ‹æœ€æ–°é€šçŸ¥</button>
      <button v-else="isNotificationLoading"
              class="half"
              style="opacity: .6; margin-right: 10px;">åˆ·æ–°ä¸­â€¦</button>
      <button class="half"
              v-if="!isNotificationCheckingFunctionEnabled"
              @click.self.stop="toggleNotificationFunction(true)">å¼€å¯é˜…è¯»å†å²</button>
      <button class="half"
              v-else
              @click.self.stop="toggleNotificationFunction(false)">å…³é—­é˜…è¯»å†å²</button>
    </div>
    <!-- å›¾ç‰‡æŸ¥çœ‹å™¨ -->
    <div id="image"
         v-if="enlargedImage">
      <div>
        <img :src="enlargedImage"
             @click.self.stop="enlargedImage = ''">
        <span @click.self.stop="openImage()">æŸ¥çœ‹åŸå›¾</span>
      </div>
    </div>
  </div>
  <script src="scripts/axios.min.js"></script>
  <script src="scripts/socket.io.js"></script>
  <script src="scripts/qrcode.min.js"></script>
  <script src="popup.js"></script>
</body>

</html>