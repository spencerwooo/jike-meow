<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <link rel="stylesheet"
        href="style/index.css">
  <script src="scripts/vue.min.js"></script>
</head>

<body>
  <div id="app">
    <div id="login"
         v-if="!access_token && ui">
      <div id="qrcode-container">
        <div class="qrcode-framer"
             v-if="qr_loading">
          <p v-if="qr_scanning">è¯·åœ¨æ‰‹æœºä¸Šç‚¹å‡»<br><b>ç¡®è®¤ç™»é™†</b></p>
        </div>
        <div id="qrcode"></div>
      </div>
    </div>
    <div id="notification"
         v-if="access_token && notifications && ui">
      <div class="n-item"
           v-for="item in notifications"
           :class="{ viewed: item.isViewed }">
        <!-- ç‚¹èµ - åŠ¨æ€ -->
        <div class="n-like-personal-update"
             v-if="item.type === 'LIKE_PERSONAL_UPDATE'">
          <div class="n-like-users">
            <div class="n-like-users-name">
              <a v-for="user in item.actionItem.users">{{ user.screenName }}</a>
              <span v-if="item.actionItem.users.length > 1">ç­‰ {{ item.actionItem.usersCount }} äºº</span>èµäº†ä½ çš„åŠ¨æ€
            </div>
            <div class="n-like-users-avatar">
              <a v-for="avatar in item.actionItem.users"
                 :href="'https://web.okjike.com/user/' + avatar.username"
                 :class="{ verified: avatar.isVerified }"
                 :style="{ backgroundImage: 'url(' + avatar.profileImageUrl + ')' }"
                 target="_blank"></a>
            </div>
          </div>
          <div class="n-like-inline-block">
            <!-- åŠ¨æ€ - æœ‰å›¾ -->
            <a class="n-like-post"
               v-if="item.referenceItem.referenceImageUrl"
               :style="{ backgroundImage: 'url(' + item.referenceItem.referenceImageUrl + ')' }"
               :href="'https://web.okjike.com/' + (item.referenceItem.type === 'OFFICIAL_MESSAGE' ? 'message-detail/' : 'post-detail/') + item.referenceItem.id + '/' + (item.referenceItem.type === 'ORIGINAL_POST' ? 'originalPost' : item.referenceItem.type === 'OFFICIAL_MESSAGE' ? 'officialMessage' : item.referenceItem.type)"
               target="_blank">
              <span v-if="!item.referenceItem.referenceImageUrl">{{ item.referenceItem.content }}</span>
            </a>
            <!-- åŠ¨æ€ - æ— å›¾ -->
            <a class="n-like-post"
               v-else
               :href="'https://web.okjike.com/' + (item.referenceItem.type === 'OFFICIAL_MESSAGE' ? 'message-detail/' : 'post-detail/') + item.referenceItem.id + '/' + (item.referenceItem.type === 'ORIGINAL_POST' ? 'originalPost' : item.referenceItem.type === 'OFFICIAL_MESSAGE' ? 'officialMessage' : item.referenceItem.type)"
               target="_blank">
              <span v-if="!item.referenceItem.referenceImageUrl">{{ item.referenceItem.content }}</span>
            </a>
          </div>
        </div>
        <!-- ç‚¹èµ - è¯„è®º -->
        <div class="n-like-personal-update"
             v-else-if="item.type === 'LIKE_PERSONAL_UPDATE_COMMENT' ||
             item.type === 'LIKE_COMMENT'">
          <div class="n-like-users">
            <div class="n-like-users-name">
              <a v-for="user in item.actionItem.users">{{ user.screenName }}</a>
              <span v-if="item.actionItem.users.length > 1">ç­‰ {{ item.actionItem.usersCount }} äºº</span>èµäº†ä½ çš„è¯„è®º
            </div>
            <div class="n-like-users-avatar">
              <a v-for="avatar in item.actionItem.users"
                 :class="{ verified: avatar.isVerified }"
                 :href="'https://web.okjike.com/user/' + avatar.username"
                 :style="{ backgroundImage: 'url(' + avatar.profileImageUrl + ')' }"
                 target="_blank"></a>
            </div>
          </div>
          <div class="n-like-inline-block">
            <a class="n-like-post"
               :href="'https://web.okjike.com/' + (item.referenceItem.targetType === 'OFFICIAL_MESSAGE' ? 'message-detail/' : 'post-detail/') + item.referenceItem.targetId + '/' + (item.referenceItem.targetType === 'ORIGINAL_POST' ? 'originalPost' : item.referenceItem.targetType === 'OFFICIAL_MESSAGE' ? 'officialMessage' : item.referenceItem.targetType)"
               target="_blank">
              <span v-if="!item.referenceItem.referenceImageUrl">{{ item.referenceItem.content }}</span>
            </a>
          </div>
        </div>
        <!-- è½¬å‘ -->
        <div class="n-personal-update-reposted"
             v-else-if="item.type === 'PERSONAL_UPDATE_REPOSTED'">
          <a class="n-repost-avatar"
             target="_blank"
             :class="{ verified: item.actionItem.users[0].isVerified }"
             :style="{ backgroundImage: 'url(' + item.actionItem.users[0].profileImageUrl + ')' }"
             :href="'https://web.okjike.com/user/' + item.actionItem.users[0].username"></a>
          <div class="n-repost-user">
            <p class="n-repost-users-name">{{ item.actionItem.users[0].screenName }} è½¬å‘äº†ä½ çš„åŠ¨æ€</p>
            <p class="n-repost-users-comment">{{ item.actionItem.content ? item.actionItem.content + '&nbsp;' : '' }}
              <a target="_blank"
                 v-if="item.actionItem.pictures.length > 0">æŸ¥çœ‹å›¾ç‰‡</a>
            </p>
          </div>
          <div class="n-like-inline-block">
            <!-- åŠ¨æ€ - æœ‰å›¾ -->
            <a class="n-repost-post"
               v-if="item.referenceItem.referenceImageUrl"
               :style="{ backgroundImage: 'url(' + item.referenceItem.referenceImageUrl + ')' }"
               :href="'https://web.okjike.com/' + (item.referenceItem.type === 'OFFICIAL_MESSAGE' ? 'message-detail/' : 'post-detail/') + item.referenceItem.id + '/' + (item.referenceItem.type === 'ORIGINAL_POST' ? 'originalPost' : item.referenceItem.type === 'OFFICIAL_MESSAGE' ? 'officialMessage' : item.referenceItem.type)"
               target="_blank">
              <span v-if="!item.referenceItem.referenceImageUrl">{{ item.referenceItem.content }}</span>
            </a>
            <!-- åŠ¨æ€ - æ— å›¾ -->
            <a class="n-repost-post"
               v-else
               :href="'https://web.okjike.com/' + (item.referenceItem.type === 'OFFICIAL_MESSAGE' ? 'message-detail/' : 'post-detail/') + item.referenceItem.id + '/' + (item.referenceItem.type === 'ORIGINAL_POST' ? 'originalPost' : item.referenceItem.type === 'OFFICIAL_MESSAGE' ? 'officialMessage' : item.referenceItem.type)"
               target="_blank">
              <span v-if="!item.referenceItem.referenceImageUrl">{{ item.referenceItem.content }}</span>
            </a>
          </div>
        </div>
        <!-- è¯„è®º -->
        <div class="n-comment-personal-update"
             v-else-if="item.type === 'COMMENT_PERSONAL_UPDATE'">
          <a class="n-comment-avatar"
             target="_blank"
             :class="{ verified: item.actionItem.users[0].isVerified }"
             :style="{ backgroundImage: 'url(' + item.actionItem.users[0].profileImageUrl + ')' }"
             :href="'https://web.okjike.com/user/' + item.actionItem.users[0].username"></a>
          <div class="n-comment-user">
            <p class="n-comment-users-name">
              <span>{{ item.actionItem.users[0].screenName }}</span> è¯„è®ºäº†ä½ 
            </p>
            <p class="n-comment-users-comment">{{ item.actionItem.content ? item.actionItem.content + '&nbsp;' : '' }}
              <a target="_blank"
                 :href="item.actionItem.pictures[0].picUrl"
                 v-if="item.actionItem.pictures.length > 0">æŸ¥çœ‹å›¾ç‰‡</a>
            </p>
          </div>
          <div class="n-like-inline-block">
            <!-- åŠ¨æ€ - æœ‰å›¾ -->
            <a class="n-comment-post"
               v-if="item.referenceItem.referenceImageUrl"
               :style="{ backgroundImage: 'url(' + item.referenceItem.referenceImageUrl + ')' }"
               :href="'https://web.okjike.com/' + (item.referenceItem.type === 'OFFICIAL_MESSAGE' ? 'message-detail/' : 'post-detail/') + item.referenceItem.id + '/' + (item.referenceItem.type === 'ORIGINAL_POST' ? 'originalPost' : item.referenceItem.type === 'OFFICIAL_MESSAGE' ? 'officialMessage' : item.referenceItem.type)"
               target="_blank">
              <span v-if="!item.referenceItem.referenceImageUrl">{{ item.referenceItem.content }}</span>
            </a>
            <!-- åŠ¨æ€ - æ— å›¾ -->
            <a class="n-comment-post"
               v-else
               :href="'https://web.okjike.com/' + (item.referenceItem.type === 'OFFICIAL_MESSAGE' ? 'message-detail/' : 'post-detail/') + item.referenceItem.id + '/' + (item.referenceItem.type === 'ORIGINAL_POST' ? 'originalPost' : item.referenceItem.type === 'OFFICIAL_MESSAGE' ? 'officialMessage' : item.referenceItem.type)"
               target="_blank">
              <span v-if="!item.referenceItem.referenceImageUrl">{{ item.referenceItem.content }}</span>
            </a>
          </div>
        </div>
        <!-- å›å¤ -->
        <div class="n-comment-personal-update"
             v-else-if="item.type === 'REPLIED_TO_PERSONAL_UPDATE_COMMENT' ||
             item.type === 'REPLY_TO_COMMENT'">
          <a class="n-comment-avatar"
             target="_blank"
             :class="{ verified: item.actionItem.users[0].isVerified }"
             :style="{ backgroundImage: 'url(' + item.actionItem.users[0].profileImageUrl + ')' }"
             :href="'https://web.okjike.com/user/' + item.actionItem.users[0].username"></a>
          <div class="n-comment-user">
            <p class="n-comment-users-name">
              <span>{{ item.actionItem.users[0].screenName }}</span> å›å¤äº†ä½ 
            </p>
            <p class="n-comment-users-comment">{{ item.actionItem.content ? item.actionItem.content + '&nbsp;' : '' }}
              <a target="_blank"
                 :href="item.actionItem.pictures[0].picUrl"
                 v-if="item.actionItem.pictures.length > 0">æŸ¥çœ‹å›¾ç‰‡</a>
            </p>
          </div>
          <div class="n-like-inline-block">
            <!-- åŠ¨æ€ - æœ‰å›¾ -->
            <a class="n-comment-post"
               v-if="item.referenceItem.referenceImageUrl"
               :style="{ backgroundImage: 'url(' + item.referenceItem.referenceImageUrl + ')' }"
               :href="'https://web.okjike.com/' + (item.referenceItem.targetType === 'OFFICIAL_MESSAGE' ? 'message-detail/' : 'post-detail/') + item.referenceItem.targetId + '/' + (item.referenceItem.targetType === 'ORIGINAL_POST' ? 'originalPost' : item.referenceItem.targetType === 'OFFICIAL_MESSAGE' ? 'officialMessage' : item.referenceItem.targetType)"
               target="_blank">
              <span v-if="!item.referenceItem.referenceImageUrl">{{ item.referenceItem.content }}</span>
            </a>
            <!-- åŠ¨æ€ - æ— å›¾ -->
            <a class="n-comment-post"
               v-else
               :href="'https://web.okjike.com/' + (item.referenceItem.targetType === 'OFFICIAL_MESSAGE' ? 'message-detail/' : 'post-detail/') + item.referenceItem.targetId + '/' + (item.referenceItem.targetType === 'ORIGINAL_POST' ? 'originalPost' : item.referenceItem.targetType === 'OFFICIAL_MESSAGE' ? 'officialMessage' : item.referenceItem.targetType)"
               target="_blank">
              <span v-if="!item.referenceItem.referenceImageUrl">{{ item.referenceItem.content }}</span>
            </a>
          </div>
        </div>
        <!-- æ–°å…³æ³¨ -->
        <div class="n-user-followed"
             v-else-if="item.type === 'USER_FOLLOWED'">
          <a class="n-comment-avatar"
             target="_blank"
             :class="{ verified: item.actionItem.users[0].isVerified }"
             :style="{ backgroundImage: 'url(' + item.actionItem.users[0].profileImageUrl + ')' }"
             :href="'https://web.okjike.com/user/' + item.actionItem.users[0].username"></a>
          <div class="n-comment-user">
            <p class="n-comment-users-name">
              <span>{{ item.actionItem.users[0].screenName }}</span> å…³æ³¨äº†ä½ 
            </p>
            <p class="n-comment-users-comment">{{ item.actionItem.users[0].briefIntro }}</p>
          </div>
          <div class="n-like-inline-block">
            <a class="n-comment-post"></a>
          </div>
        </div>
        <!-- æœªçŸ¥æ¶ˆæ¯ç±»å‹ -->
        <div class="n-unknown"
             v-else>
          <div>ä¸æ”¯æŒçš„æ¶ˆæ¯ç±»å‹<br>
            <a href="https://github.com/coder-ysj/jike-meow/issues/"
               target="_blank">ç‚¹å‡»æ­¤å¤„</a> åé¦ˆç»™ä½œè€…</div>
        </div>
        <!-- æ—¶é—´æ˜¾ç¤º -->
        <div class="n-time-display">{{ reformatTime(item.updatedAt) }}</div>
      </div>
      <!-- æ­£åœ¨åŠ è½½ -->
      <p id="notification-loading"
         v-if="notificationsIsLoading">ğŸ± æ­£åœ¨åŠ è½½æ•°æ®â€¦</p>
      <!-- åŠ è½½å¤±è´¥ -->
      <p id="notification-error"
         v-if="error"
         @click.self.stop="getNotificationList()">ğŸŒš åŠ è½½å¤±è´¥ï¼Œè¯·ç‚¹å‡»é‡è¯•</p>
    </div>
    <button class="primary"
            @click.self.stop="getUuid()"
            v-if="!access_token && ui">åˆ·æ–°äºŒç»´ç </button>
    <div id="button-container"
         v-if="access_token && ui">
      <button class="primary half"
              @click.self.stop="logIn()">ç½‘é¡µç™»å½•</button>
      <button class="primary half"
              style="margin-left: 10px;"
              @click.self.stop="logOut()">é€€å‡ºç™»å½•</button>
    </div>
    <button v-if="auth_token && !notificationsIsLoading"
            @click.self.stop="getNotificationList('refresh')">çœ‹çœ‹æœ‰å“ªäº›æ–°é€šçŸ¥</button>
    <button v-else-if="auth_token && notificationsIsLoading"
            style="opacity: .6;">åˆ·æ–°ä¸­â€¦</button>
  </div>
  <script src="scripts/axios.min.js"></script>
  <script src="scripts/socket.io.js"></script>
  <script src="scripts/qrcode.min.js"></script>
  <script src="popup.js"></script>
</body>

</html>